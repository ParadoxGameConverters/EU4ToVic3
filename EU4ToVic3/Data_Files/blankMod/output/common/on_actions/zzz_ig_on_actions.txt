# For on_actions launched by the code itself.

# Root = Country
on_yearly_pulse_country = {
	#Holy Order Secularization
	random_events = {
		4 = 0
		1 = zzz_cc_politics.1
	}
}

# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_own_subject = {
	effect = {
		if = {
			limit = {
				c:NEN ?= scope:target
			}
			scope:target = {
				create_character = {
					ig_leader = yes
					interest_group = ig_rural_folk
					ideology = ideology_luddite
				}
			}
		}
		if = {
			limit = {
				scope:target = {
					country_has_primary_culture = cu:ashkenazi
				}
				NOT = {
					s:STATE_PALESTINE = {
						is_homeland = cu:ashkenazi
					}
				}
			}
			s:STATE_PALESTINE = {
				add_homeland = cu:sephardic
				add_homeland = cu:ashkenazi
			}
		}
		scope:target = { converter_released_country_effect = yes }		##Converter
	}
}

# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_overlord_subject = {
	effect = {
		if = {
			limit = {
				scope:target = {
					country_has_primary_culture = cu:ashkenazi
				}
				NOT = {
					s:STATE_PALESTINE = {
						is_homeland = cu:ashkenazi
					}
				}
			}
			s:STATE_PALESTINE = {
				add_homeland = cu:sephardic
				add_homeland = cu:ashkenazi
			}
		}
		scope:target = { converter_released_country_effect = yes }		##Converter
	}
}

# Root = Country
# scope:target = Uprising country
on_revolution_start = {
	effect = {
		scope:target = {
			converter_copy_ideologies_effect = yes		##Converter
			enact_preferred_governance_principle = yes
		}
		if = {
			limit = {
				has_law = law_type:law_monarchy
				scope:target = {
					NOT = {
						has_law = law_type:law_monarchy
					}
				}
			}
			set_variable = anti_monarchist_revolution
		}
		if = {
			limit = {
				has_journal_entry = je_warlord_china
				NOT = { has_variable = china_warlord_explosion_revolution }
			}
			post_notification = warlord_china_explosion_point_add
			change_variable = {
				name = china_warlord_explosion
				add = 1
			}
			set_variable = china_warlord_explosion_revolution
		}
		if = {
			limit = {
				has_journal_entry = je_meiji_restoration
				scope:target = {
					ig:ig_landowners = {
						is_in_government = yes
					}
				}
			}
			set_variable = anti_shogunate_civil_war
		}
		if = {
			limit = {
				has_journal_entry = je_the_paris_commune_france
			}
			c:FRA = {
				trigger_event = { id = paris_commune.4 popup = yes }
			}
			random_scope_state = {
				limit = {
					state_region = s:STATE_ILE_DE_FRANCE
				}
				set_state_owner = c:PRC
			}
			c:PRC = {
				annex = scope:target
				create_diplomatic_play = {
					type = dp_annex_war
					target_state = c:FRA.capital
					annex_as_civil_war = yes
					add_war_goal = {
						holder = c:FRA
						type = annex_country
						target_country = c:PRC
					}
				}
			}
		}
		if = {
			limit = {
				has_dlc_feature = voice_of_the_people_content
				c:KRA ?= root
				c:AUS ?= {
					any_subject_or_below = {
						c:KRA ?= this
					}
				}
			}
			c:AUS = {
				trigger_event = { id = krakow.1 days = 3 popup = yes }
			}
		}
	}
}

# Root = Country
# scope:target = Uprising country
on_secession_start = {
	effect = {
		if = {
			limit = {
				has_journal_entry = je_warlord_china
				NOT = { has_variable = china_warlord_explosion_revolution }
			}
			post_notification = warlord_china_explosion_point_add
			change_variable = {
				name = china_warlord_explosion
				add = 1
			}
			set_variable = china_warlord_explosion_revolution
		}
		scope:target = { converter_released_country_effect = yes }		##Converter
	}
}

# Root = Country
# scope:target = Uprising country
on_secession_end = {
	effect = {
		scope:target = {		##Converter
			every_primary_culture = {
				limit = {
					OR = {
						is_target_in_global_variable_list = { name = global_canadian_cultures target = this }
						is_target_in_global_variable_list = { name = global_american_cultures target = this }
						is_target_in_global_variable_list = { name = global_californian_cultures target = this }
						is_target_in_global_variable_list = { name = global_mexican_cultures target = this }
						is_target_in_global_variable_list = { name = global_colombian_cultures target = this }
						is_target_in_global_variable_list = { name = global_andean_cultures target = this }
						is_target_in_global_variable_list = { name = global_platinean_cultures target = this }
						is_target_in_global_variable_list = { name = global_brazilian_cultures target = this }
						is_target_in_global_variable_list = { name = global_australian_cultures target = this }
						is_target_in_global_variable_list = { name = global_cape_cultures target = this }
					}
					NOT = { is_target_in_global_variable_list = { name = global_colonial_primary_cultures target = this } }
				}
				add_to_global_variable_list = {
					name = global_colonial_primary_cultures
					target = this
				}
			}
		}
	}
}
