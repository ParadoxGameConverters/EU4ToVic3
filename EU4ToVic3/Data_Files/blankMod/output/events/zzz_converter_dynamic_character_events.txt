namespace = zzz_cc_dynamic_characters

zzz_cc_dynamic_characters.1 = {
	type = country_event # It means that, root is the country which happend the event, instead of state.
	hidden = yes # if there are no option, make it hidden
	
	trigger = {
		any_primary_culture = {
			OR = {
				is_target_in_global_variable_list = { name = global_utilitarian_cultures target = this }
				is_target_in_global_variable_list = { name = global_integralist_cultures target = this }
			}
		}
	}

	immediate = {
		if = {
			limit = {
				any_primary_culture = { is_target_in_global_variable_list = { name = global_utilitarian_cultures target = this } }
			}
			overlord = {
				every_primary_culture = {
					limit = {
						NOT = { is_target_in_global_variable_list = { name = global_utilitarian_cultures target = this } }
					}
					add_to_global_variable_list = {
						name = global_utilitarian_cultures
						target = this
					}
				}
				every_subject_or_below = {
					limit = {
						any_primary_culture = {
							trigger_if = {
								limit = { shares_heritage_trait_group_with_any_primary_culture = root.overlord }
								shares_language_trait_with_any_primary_culture = root.overlord
							}
							trigger_else = { shares_language_trait_group_with_any_primary_culture = root.overlord }
							NOT = { is_target_in_global_variable_list = { name = global_utilitarian_cultures target = this } }
						}
					}
					every_primary_culture = {
						limit = {
							trigger_if = {
								limit = { shares_heritage_trait_group_with_any_primary_culture = root.overlord }
								shares_language_trait_with_any_primary_culture = root.overlord
							}
							trigger_else = { shares_language_trait_group_with_any_primary_culture = root.overlord }
							NOT = { is_target_in_global_variable_list = { name = global_utilitarian_cultures target = this } }
						}
						add_to_global_variable_list = {
							name = global_utilitarian_cultures
							target = this
						}
					}
				}
			}
		}
		if = {
			limit = {
				any_primary_culture = { is_target_in_global_variable_list = { name = global_integralist_cultures target = this } }
			}
			every_country = {
				limit = {
					OR = {
						country_has_state_religion = rel:catholic
						var:ancien_regime_religion ?= rel:catholic
					}
					any_primary_culture = {
						trigger_if = {
							limit = { shares_heritage_trait_group_with_any_primary_culture = root }
							shares_language_trait_with_any_primary_culture = root
						}
						trigger_else = { shares_language_trait_group_with_any_primary_culture = root }
						NOT = { is_target_in_global_variable_list = { name = global_integralist_cultures target = this } }
					}
					is_not_in_geographic_region = geographic_region_americas
				}
				converter_integralist_ideology_effect = yes
			}
		}
	}
}